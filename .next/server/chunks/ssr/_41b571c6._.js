module.exports=[3130,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},41078,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(21958),f=a.i(54161),g=a.i(7706),h=a.i(77687),i=a.i(83077),j=a.i(70106);let k=(0,j.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),l=(0,j.default)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);var m=a.i(96221);a.i(35025);var n=a.i(9701),o=a.i(11543);function p(){let{toast:a}=(0,h.useToast)(),[j,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(""),w=(0,n.createBrowserClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);(0,c.useEffect)(()=>{(async()=>{try{let b=localStorage.getItem("selected_guild");if(!b)return;let c=new Date,d=c.getFullYear(),e=x(c),f=`${d}-W${e.toString().padStart(2,"0")}`;v(f),console.log("[v0] Fetching leaderboard for week:",f);let{data:g,error:h}=await w.from("leaderboards").select("msgs, voice").eq("guild_id",b).eq("week",f).single();if(h){console.error("[v0] Error fetching leaderboard:",h),a({title:"Erreur",description:"Impossible de charger le leaderboard",variant:"destructive"});return}if(console.log("[v0] Leaderboard data:",g),g?.msgs){let a=Object.entries(g.msgs).map(([a,b])=>({discordId:a,count:b})).sort((a,b)=>b.count-a.count).slice(0,10),c=a.map(a=>a.discordId),d=await (0,o.getDiscordProfiles)(c,b),e=a.map((a,b)=>{let c=d.get(a.discordId)||{username:"Utilisateur inconnu",avatar:"https://cdn.discordapp.com/embed/avatars/0.png"};return{rank:b+1,discordId:a.discordId,username:c.username,avatar:c.avatar,value:a.count}});r(e)}if(g?.voice){let a=Object.entries(g.voice).map(([a,b])=>({discordId:a,seconds:b})).sort((a,b)=>b.seconds-a.seconds).slice(0,10),c=a.map(a=>a.discordId),d=await (0,o.getDiscordProfiles)(c,b),e=a.map((a,b)=>{let c=d.get(a.discordId)||{username:"Utilisateur inconnu",avatar:"https://cdn.discordapp.com/embed/avatars/0.png"};return{rank:b+1,discordId:a.discordId,username:c.username,avatar:c.avatar,value:a.seconds}});t(e)}}catch(b){console.error("[v0] Error loading leaderboard:",b),a({title:"Erreur",description:"Impossible de charger le leaderboard",variant:"destructive"})}finally{p(!1)}})()},[a]);let x=a=>{let b=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())),c=b.getUTCDay()||7;b.setUTCDate(b.getUTCDate()+4-c);let d=new Date(Date.UTC(b.getUTCFullYear(),0,1));return Math.ceil(((b.getTime()-d.getTime())/864e5+1)/7)};return j?(0,b.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,b.jsx)(m.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Leaderboards"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Classements hebdomadaires - Semaine ",u]})]}),(0,b.jsxs)(e.Tabs,{defaultValue:"messages",className:"w-full",children:[(0,b.jsxs)(e.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsxs)(e.TabsTrigger,{value:"messages",className:"gap-2",children:[(0,b.jsx)(k,{className:"h-4 w-4"}),"Messages"]}),(0,b.jsxs)(e.TabsTrigger,{value:"voice",className:"gap-2",children:[(0,b.jsx)(l,{className:"h-4 w-4"}),"Vocal"]})]}),(0,b.jsx)(e.TabsContent,{value:"messages",className:"mt-6",children:(0,b.jsxs)(d.Card,{className:"border-border bg-card",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Trophy,{className:"h-5 w-5 text-yellow-500"}),"Top 10 Messages"]}),(0,b.jsx)(d.CardDescription,{children:"Les membres les plus actifs en messages cette semaine"})]}),(0,b.jsx)(d.CardContent,{children:0===q.length?(0,b.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"Aucune donnée disponible pour cette semaine"}):(0,b.jsx)("div",{className:"space-y-3",children:q.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-4 rounded-2xl bg-muted/50 p-4 transition-all hover:bg-muted",children:[(0,b.jsxs)("div",{className:`flex h-12 w-12 shrink-0 items-center justify-center rounded-xl font-bold ${1===a.rank?"bg-yellow-500/20 text-yellow-500":2===a.rank?"bg-gray-400/20 text-gray-400":3===a.rank?"bg-orange-600/20 text-orange-600":"bg-primary/10 text-primary"}`,children:["#",a.rank]}),(0,b.jsxs)(g.Avatar,{className:"h-12 w-12 border-2 border-border",children:[(0,b.jsx)(g.AvatarImage,{src:a.avatar||"/placeholder.svg",alt:a.username}),(0,b.jsx)(g.AvatarFallback,{children:a.username[0]?.toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground",children:a.username}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.value," messages"]})]}),1===a.rank&&(0,b.jsxs)(f.Badge,{className:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",children:[(0,b.jsx)(i.Trophy,{className:"mr-1 h-3 w-3"}),"Champion"]})]},a.discordId))})})]})}),(0,b.jsx)(e.TabsContent,{value:"voice",className:"mt-6",children:(0,b.jsxs)(d.Card,{className:"border-border bg-card",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Trophy,{className:"h-5 w-5 text-yellow-500"}),"Top 10 Vocal"]}),(0,b.jsx)(d.CardDescription,{children:"Les membres les plus actifs en vocal cette semaine"})]}),(0,b.jsx)(d.CardContent,{children:0===s.length?(0,b.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"Aucune donnée disponible pour cette semaine"}):(0,b.jsx)("div",{className:"space-y-3",children:s.map(a=>{var c;let d,e;return(0,b.jsxs)("div",{className:"flex items-center gap-4 rounded-2xl bg-muted/50 p-4 transition-all hover:bg-muted",children:[(0,b.jsxs)("div",{className:`flex h-12 w-12 shrink-0 items-center justify-center rounded-xl font-bold ${1===a.rank?"bg-yellow-500/20 text-yellow-500":2===a.rank?"bg-gray-400/20 text-gray-400":3===a.rank?"bg-orange-600/20 text-orange-600":"bg-primary/10 text-primary"}`,children:["#",a.rank]}),(0,b.jsxs)(g.Avatar,{className:"h-12 w-12 border-2 border-border",children:[(0,b.jsx)(g.AvatarImage,{src:a.avatar||"/placeholder.svg",alt:a.username}),(0,b.jsx)(g.AvatarFallback,{children:a.username[0]?.toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground",children:a.username}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:(d=Math.floor((c=a.value)/3600),e=Math.floor(c%3600/60),d>0?`${d}h ${e}m`:`${e}m`)})]}),1===a.rank&&(0,b.jsxs)(f.Badge,{className:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",children:[(0,b.jsx)(i.Trophy,{className:"mr-1 h-3 w-3"}),"Champion"]})]},a.discordId)})})})]})})]})]})}a.s(["default",()=>p],41078)}];

//# sourceMappingURL=_41b571c6._.js.map