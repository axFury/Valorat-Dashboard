(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function s({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...a})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>n,"CardDescription",()=>o,"CardHeader",()=>s,"CardTitle",()=>i])},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},9156,(e,t,r)=>{"use strict";let a;Object.defineProperty(r,"__esModule",{value:!0}),r.parseCookie=u,r.parse=u,r.stringifyCookie=function(e,t){let r=t?.encode||encodeURIComponent,a=[];for(let t of Object.keys(e)){let o=e[t];if(void 0===o)continue;if(!s.test(t))throw TypeError(`cookie name is invalid: ${t}`);let n=r(o);if(!i.test(n))throw TypeError(`cookie val is invalid: ${o}`);a.push(`${t}=${n}`)}return a.join("; ")},r.stringifySetCookie=m,r.serialize=m,r.parseSetCookie=function(e,t){let r=t?.decode||g,a=e.length,s=f(e,0,a),i=p(e,0,s),o=-1===i?{name:"",value:r(h(e,0,s))}:{name:h(e,0,i),value:r(h(e,i+1,s))},n=s+1;for(;n<a;){let t=f(e,n,a),r=p(e,n,t),s=-1===r?h(e,n,t):h(e,n,r),i=-1===r?void 0:h(e,r+1,t);switch(s.toLowerCase()){case"httponly":o.httpOnly=!0;break;case"secure":o.secure=!0;break;case"partitioned":o.partitioned=!0;break;case"domain":o.domain=i;break;case"path":o.path=i;break;case"max-age":i&&l.test(i)&&(o.maxAge=Number(i));break;case"expires":if(!i)break;let c=new Date(i);Number.isFinite(c.valueOf())&&(o.expires=c);break;case"priority":if(!i)break;let d=i.toLowerCase();("low"===d||"medium"===d||"high"===d)&&(o.priority=d);break;case"samesite":if(!i)break;let u=i.toLowerCase();("lax"===u||"strict"===u||"none"===u)&&(o.sameSite=u)}n=t+1}return o},r.stringifySetCookie=m,r.serialize=m;let s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,i=/^[\u0021-\u003A\u003C-\u007E]*$/,o=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,l=/^-?\d+$/,c=Object.prototype.toString,d=((a=function(){}).prototype=Object.create(null),a);function u(e,t){let r=new d,a=e.length;if(a<2)return r;let s=t?.decode||g,i=0;do{let t=p(e,i,a);if(-1===t)break;let o=f(e,i,a);if(t>o){i=e.lastIndexOf(";",t-1)+1;continue}let n=h(e,i,t);void 0===r[n]&&(r[n]=s(h(e,t+1,o))),i=o+1}while(i<a)return r}function m(e,t,r){let a="object"==typeof e?e:{...r,name:e,value:String(t)},l=("object"==typeof t?t:r)?.encode||encodeURIComponent;if(!s.test(a.name))throw TypeError(`argument name is invalid: ${a.name}`);let d=a.value?l(a.value):"";if(!i.test(d))throw TypeError(`argument val is invalid: ${a.value}`);let u=a.name+"="+d;if(void 0!==a.maxAge){if(!Number.isInteger(a.maxAge))throw TypeError(`option maxAge is invalid: ${a.maxAge}`);u+="; Max-Age="+a.maxAge}if(a.domain){if(!o.test(a.domain))throw TypeError(`option domain is invalid: ${a.domain}`);u+="; Domain="+a.domain}if(a.path){if(!n.test(a.path))throw TypeError(`option path is invalid: ${a.path}`);u+="; Path="+a.path}if(a.expires){var m;if(m=a.expires,"[object Date]"!==c.call(m)||!Number.isFinite(a.expires.valueOf()))throw TypeError(`option expires is invalid: ${a.expires}`);u+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(u+="; HttpOnly"),a.secure&&(u+="; Secure"),a.partitioned&&(u+="; Partitioned"),a.priority)switch("string"==typeof a.priority?a.priority.toLowerCase():void 0){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${a.priority}`)}if(a.sameSite)switch("string"==typeof a.sameSite?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"none":u+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${a.sameSite}`)}return u}function f(e,t,r){let a=e.indexOf(";",t);return -1===a?r:a}function p(e,t,r){let a=e.indexOf("=",t);return a<r?a:-1}function h(e,t,r){let a=t,s=r;do{let t=e.charCodeAt(a);if(32!==t&&9!==t)break}while(++a<s)for(;s>a;){let t=e.charCodeAt(s-1);if(32!==t&&9!==t)break;s--}return e.slice(a,s)}function g(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},52683,(e,t,r)=>{},27341,72390,29225,30536,e=>{"use strict";let t;var r=e.i(43476),a=e.i(71645),s=e.i(81140),i=e.i(30030),o=e.i(42727),n=e.i(96626),l=e.i(48425),c=e.i(86318),d=e.i(69340),u=e.i(10772),m="Tabs",[f,p]=(0,i.createContextScope)(m,[o.createRovingFocusGroupScope]),h=(0,o.createRovingFocusGroupScope)(),[g,v]=f(m),b=a.forwardRef((e,t)=>{let{__scopeTabs:a,value:s,onValueChange:i,defaultValue:o,orientation:n="horizontal",dir:m,activationMode:f="automatic",...p}=e,h=(0,c.useDirection)(m),[v,b]=(0,d.useControllableState)({prop:s,onChange:i,defaultProp:o});return(0,r.jsx)(g,{scope:a,baseId:(0,u.useId)(),value:v,onValueChange:b,orientation:n,dir:h,activationMode:f,children:(0,r.jsx)(l.Primitive.div,{dir:h,"data-orientation":n,...p,ref:t})})});b.displayName=m;var x="TabsList",y=a.forwardRef((e,t)=>{let{__scopeTabs:a,loop:s=!0,...i}=e,n=v(x,a),c=h(a);return(0,r.jsx)(o.Root,{asChild:!0,...c,orientation:n.orientation,dir:n.dir,loop:s,children:(0,r.jsx)(l.Primitive.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:t})})});y.displayName=x;var w="TabsTrigger",k=a.forwardRef((e,t)=>{let{__scopeTabs:a,value:i,disabled:n=!1,...c}=e,d=v(w,a),u=h(a),m=A(d.baseId,i),f=N(d.baseId,i),p=i===d.value;return(0,r.jsx)(o.Item,{asChild:!0,...u,focusable:!n,active:p,children:(0,r.jsx)(l.Primitive.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":f,"data-state":p?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:m,...c,ref:t,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():d.onValueChange(i)}),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&d.onValueChange(i)}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==d.activationMode;p||n||!e||d.onValueChange(i)})})})});k.displayName=w;var j="TabsContent",C=a.forwardRef((e,t)=>{let{__scopeTabs:s,value:i,forceMount:o,children:c,...d}=e,u=v(j,s),m=A(u.baseId,i),f=N(u.baseId,i),p=i===u.value,h=a.useRef(p);return a.useEffect(()=>{let e=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,r.jsx)(n.Presence,{present:o||p,children:({present:a})=>(0,r.jsx)(l.Primitive.div,{"data-state":p?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!a,id:f,tabIndex:0,...d,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:a&&c})})});function A(e,t){return`${e}-trigger-${t}`}function N(e,t){return`${e}-content-${t}`}C.displayName=j;var S=e.i(47163);function E({className:e,...t}){return(0,r.jsx)(b,{"data-slot":"tabs",className:(0,S.cn)("flex flex-col gap-2",e),...t})}function T({className:e,...t}){return(0,r.jsx)(y,{"data-slot":"tabs-list",className:(0,S.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function I({className:e,...t}){return(0,r.jsx)(k,{"data-slot":"tabs-trigger",className:(0,S.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function _({className:e,...t}){return(0,r.jsx)(C,{"data-slot":"tabs-content",className:(0,S.cn)("flex-1 outline-none",e),...t})}e.s(["Tabs",()=>E,"TabsContent",()=>_,"TabsList",()=>T,"TabsTrigger",()=>I],27341);var $=e.i(47167),U=e.i(24632),P=e.i(9156);function O(){return"undefined"!=typeof window&&void 0!==window.document}P.parse,P.serialize;let D={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},L=/^(.*)[.](0|[1-9][0-9]*)$/;function B(e,t){if(e===t)return!0;let r=e.match(L);return!!r&&r[1]===t}function q(e,t,r){let a=r??3180,s=encodeURIComponent(t);if(s.length<=a)return[{name:e,value:t}];let i=[];for(;s.length>0;){let e=s.slice(0,a),t=e.lastIndexOf("%");t>a-3&&(e=e.slice(0,t));let r="";for(;e.length>0;)try{r=decodeURIComponent(e);break}catch(t){if(t instanceof URIError&&"%"===e.at(-3)&&e.length>3)e=e.slice(0,e.length-3);else throw t}i.push(r),s=s.slice(e.length)}return i.map((t,r)=>({name:`${e}.${r}`,value:t}))}async function M(e,t){let r=await t(e);if(r)return r;let a=[];for(let r=0;;r++){let s=`${e}.${r}`,i=await t(s);if(!i)break;a.push(i)}return a.length>0?a.join(""):null}let R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),F=" 	\n\r=".split(""),z=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<F.length;t+=1)e[F[t].charCodeAt(0)]=-2;for(let t=0;t<R.length;t+=1)e[R[t].charCodeAt(0)]=t;return e})();function H(e){let t=[],r=0,a=0;if(function(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){let t=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(a,t)}}(e,e=>{for(r=r<<8|e,a+=8;a>=6;){let e=r>>a-6&63;t.push(R[e]),a-=6}}),a>0)for(r<<=6-a,a=6;a>=6;){let e=r>>a-6&63;t.push(R[e]),a-=6}return t.join("")}function K(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},a={utf8seq:0,codepoint:0},s=0,i=0;for(let t=0;t<e.length;t+=1){let o=z[e.charCodeAt(t)];if(o>-1)for(s=s<<6|o,i+=6;i>=8;)(function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}})(s>>i-8&255,a,r),i-=8;else if(-2===o)continue;else throw Error(`Invalid Base64-URL character "${e.at(t)}" at position ${t}`)}return t.join("")}let V="base64-";async function X({getAll:e,setAll:t,setItems:r,removedItems:a},s){let i=s.cookieEncoding,o=s.cookieOptions??null,n=await e([...r?Object.keys(r):[],...a?Object.keys(a):[]]),l=n?.map(({name:e})=>e)||[],c=Object.keys(a).flatMap(e=>l.filter(t=>B(t,e))),d=Object.keys(r).flatMap(e=>{let t=new Set(l.filter(t=>B(t,e))),a=r[e];"base64url"===i&&(a=V+H(a));let s=q(e,a);return s.forEach(e=>{t.delete(e.name)}),c.push(...t),s}),u={...D,...o,maxAge:0},m={...D,...o,maxAge:D.maxAge};delete u.name,delete m.name,await t([...c.map(e=>({name:e,value:"",options:u})),...d.map(({name:e,value:t})=>({name:e,value:t,options:m}))])}function Y(e,r,a){let s=a?.isSingleton===!0||(!a||!("isSingleton"in a))&&O();if(s&&t)return t;if(!e||!r)throw Error(`@supabase/ssr: Your project's URL and API key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:i}=function(e,t){let r,a,s=e.cookies??null,i=e.cookieEncoding,o={},n={};if(s)if("get"in s){let e=async e=>{let t=e.flatMap(e=>[e,...Array.from({length:5}).map((t,r)=>`${e}.${r}`)]),r=[];for(let e=0;e<t.length;e+=1){let a=await s.get(t[e]);(a||"string"==typeof a)&&r.push({name:t[e],value:a})}return r};if(r=async t=>await e(t),"set"in s&&"remove"in s)a=async e=>{for(let t=0;t<e.length;t+=1){let{name:r,value:a,options:i}=e[t];a?await s.set(r,a,i):await s.remove(r,i)}};else if(t)a=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in s)if(r=async()=>await s.getAll(),"setAll"in s)a=s.setAll;else if(t)a=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw Error(`@supabase/ssr: ${t?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${O()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`);else if(!t&&O())r=()=>{let e;return Object.keys(e=(0,P.parse)(document.cookie)).map(t=>({name:t,value:e[t]??""}))},a=e=>{e.forEach(({name:e,value:t,options:r})=>{document.cookie=(0,P.serialize)(e,t,r)})};else if(t)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else r=()=>[],a=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};return t?{getAll:r,setAll:a,setItems:o,removedItems:n,storage:{isServer:!0,getItem:async e=>{if("string"==typeof o[e])return o[e];if(n[e])return null;let t=await r([e]),a=await M(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!a)return null;let s=a;return"string"==typeof a&&a.startsWith(V)&&(s=K(a.substring(V.length))),s},setItem:async(t,s)=>{t.endsWith("-code-verifier")&&await X({getAll:r,setAll:a,setItems:{[t]:s},removedItems:{}},{cookieOptions:e?.cookieOptions??null,cookieEncoding:i}),o[t]=s,delete n[t]},removeItem:async e=>{delete o[e],n[e]=!0}}}:{getAll:r,setAll:a,setItems:o,removedItems:n,storage:{isServer:!1,getItem:async e=>{let t=await r([e]),a=await M(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!a)return null;let s=a;return a.startsWith(V)&&(s=K(a.substring(V.length))),s},setItem:async(t,s)=>{let o=await r([t]),n=new Set((o?.map(({name:e})=>e)||[]).filter(e=>B(e,t))),l=s;"base64url"===i&&(l=V+H(s));let c=q(t,l);c.forEach(({name:e})=>{n.delete(e)});let d={...D,...e?.cookieOptions,maxAge:0},u={...D,...e?.cookieOptions,maxAge:D.maxAge};delete d.name,delete u.name;let m=[...[...n].map(e=>({name:e,value:"",options:d})),...c.map(({name:e,value:t})=>({name:e,value:t,options:u}))];m.length>0&&await a(m)},removeItem:async t=>{let s=await r([t]),i=(s?.map(({name:e})=>e)||[]).filter(e=>B(e,t)),o={...D,...e?.cookieOptions,maxAge:0};delete o.name,i.length>0&&await a(i.map(e=>({name:e,value:"",options:o})))}}}}({...a,cookieEncoding:a?.cookieEncoding??"base64url"},!1),o=(0,U.createClient)(e,r,{...a,global:{...a?.global,headers:{...a?.global?.headers,"X-Client-Info":"supabase-ssr/0.7.0 createBrowserClient"}},auth:{...a?.auth,...a?.cookieOptions?.name?{storageKey:a.cookieOptions.name}:null,flowType:"pkce",autoRefreshToken:O(),detectSessionInUrl:O(),persistSession:!0,storage:i}});return s&&(t=o),o}e.s(["createBrowserClient",()=>Y],72390),e.i(52683),e.s([],29225);let W=new Map;async function G(e,t){if(W.has(e))return console.log("[v0] Profile from session cache:",e),W.get(e);let r=Y($.default.env.NEXT_PUBLIC_SUPABASE_URL,$.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);try{let{data:t,error:a}=await r.from("profiles").select("discord_username, discord_avatar").eq("discord_id",e).single();if(!a&&t?.discord_username){console.log("[v0] Profile from Supabase:",e);let r={username:t.discord_username,avatar:t.discord_avatar||`https://cdn.discordapp.com/embed/avatars/${Number.parseInt(e)%5}.png`};return W.set(e,r),r}}catch(e){console.error("[v0] Error checking Supabase profile:",e)}console.log("[v0] Fetching profile from Discord API:",e);try{let a=await fetch(`/api/guilds/${t}/members/${e}`);if(!a.ok)throw Error("Failed to fetch user");let s=await a.json(),i=s.user?.username||s.nick||"Utilisateur inconnu",o=s.user?.avatar?`https://cdn.discordapp.com/avatars/${e}/${s.user.avatar}.png`:`https://cdn.discordapp.com/embed/avatars/${Number.parseInt(e)%5}.png`,n={username:i,avatar:o};return await r.from("profiles").upsert({discord_id:e,discord_username:i,discord_avatar:o},{onConflict:"discord_id"}),W.set(e,n),n}catch(t){return console.error("[v0] Error fetching Discord user:",e,t),{username:"Utilisateur inconnu",avatar:"https://cdn.discordapp.com/embed/avatars/0.png"}}}async function J(e,t){let r=new Map,a=[];for(let t of e)W.has(t)?r.set(t,W.get(t)):a.push(t);if(0===a.length)return console.log("[v0] All profiles from session cache"),r;let s=Y($.default.env.NEXT_PUBLIC_SUPABASE_URL,$.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);try{let{data:e,error:i}=await s.from("profiles").select("discord_id, discord_username, discord_avatar").in("discord_id",a),o=[];if(!i&&e){for(let t of(console.log("[v0] Found profiles in Supabase:",e.length),e))if(t.discord_username){let e={username:t.discord_username,avatar:t.discord_avatar||`https://cdn.discordapp.com/embed/avatars/${Number.parseInt(t.discord_id)%5}.png`};r.set(t.discord_id,e),W.set(t.discord_id,e)}for(let e of a)r.has(e)||o.push(e)}else o.push(...a);if(o.length>0){console.log("[v0] Fetching from Discord API:",o.length,"profiles");let e=o.map(e=>G(e,t)),a=await Promise.all(e);o.forEach((e,t)=>{r.set(e,a[t])})}}catch(e){console.error("[v0] Error in batch profile fetch:",e)}return r}e.s(["getDiscordProfiles",()=>J],30536)},35955,e=>{"use strict";var t=e.i(47167),r=e.i(43476),a=e.i(71645),s=e.i(70065),i=e.i(27341),o=e.i(94179),n=e.i(63270),l=e.i(20682),c=e.i(64030),d=e.i(75254);let u=(0,d.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),m=(0,d.default)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);var f=e.i(31278);e.i(29225);var p=e.i(72390),h=e.i(30536);function g(){let{toast:e}=(0,l.useToast)(),[d,g]=(0,a.useState)(!0),[v,b]=(0,a.useState)([]),[x,y]=(0,a.useState)([]),[w,k]=(0,a.useState)(""),j=(0,p.createBrowserClient)(t.default.env.NEXT_PUBLIC_SUPABASE_URL,t.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);(0,a.useEffect)(()=>{(async()=>{try{let t=localStorage.getItem("selected_guild");if(!t)return;let r=new Date,a=r.getFullYear(),s=C(r),i=`${a}-W${s.toString().padStart(2,"0")}`;k(i),console.log("[v0] Fetching leaderboard for week:",i);let{data:o,error:n}=await j.from("leaderboards").select("msgs, voice").eq("guild_id",t).eq("week",i).single();if(n){console.error("[v0] Error fetching leaderboard:",n),e({title:"Erreur",description:"Impossible de charger le leaderboard",variant:"destructive"});return}if(console.log("[v0] Leaderboard data:",o),o?.msgs){let e=Object.entries(o.msgs).map(([e,t])=>({discordId:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,10),r=e.map(e=>e.discordId),a=await (0,h.getDiscordProfiles)(r,t),s=e.map((e,t)=>{let r=a.get(e.discordId)||{username:"Utilisateur inconnu",avatar:"https://cdn.discordapp.com/embed/avatars/0.png"};return{rank:t+1,discordId:e.discordId,username:r.username,avatar:r.avatar,value:e.count}});b(s)}if(o?.voice){let e=Object.entries(o.voice).map(([e,t])=>({discordId:e,seconds:t})).sort((e,t)=>t.seconds-e.seconds).slice(0,10),r=e.map(e=>e.discordId),a=await (0,h.getDiscordProfiles)(r,t),s=e.map((e,t)=>{let r=a.get(e.discordId)||{username:"Utilisateur inconnu",avatar:"https://cdn.discordapp.com/embed/avatars/0.png"};return{rank:t+1,discordId:e.discordId,username:r.username,avatar:r.avatar,value:e.seconds}});y(s)}}catch(t){console.error("[v0] Error loading leaderboard:",t),e({title:"Erreur",description:"Impossible de charger le leaderboard",variant:"destructive"})}finally{g(!1)}})()},[e]);let C=e=>{let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);let a=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-a.getTime())/864e5+1)/7)};return d?(0,r.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,r.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Leaderboards"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["Classements hebdomadaires - Semaine ",w]})]}),(0,r.jsxs)(i.Tabs,{defaultValue:"messages",className:"w-full",children:[(0,r.jsxs)(i.TabsList,{className:"grid w-full grid-cols-2",children:[(0,r.jsxs)(i.TabsTrigger,{value:"messages",className:"gap-2",children:[(0,r.jsx)(u,{className:"h-4 w-4"}),"Messages"]}),(0,r.jsxs)(i.TabsTrigger,{value:"voice",className:"gap-2",children:[(0,r.jsx)(m,{className:"h-4 w-4"}),"Vocal"]})]}),(0,r.jsx)(i.TabsContent,{value:"messages",className:"mt-6",children:(0,r.jsxs)(s.Card,{className:"border-border bg-card",children:[(0,r.jsxs)(s.CardHeader,{children:[(0,r.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.Trophy,{className:"h-5 w-5 text-yellow-500"}),"Top 10 Messages"]}),(0,r.jsx)(s.CardDescription,{children:"Les membres les plus actifs en messages cette semaine"})]}),(0,r.jsx)(s.CardContent,{children:0===v.length?(0,r.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"Aucune donnée disponible pour cette semaine"}):(0,r.jsx)("div",{className:"space-y-3",children:v.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 rounded-2xl bg-muted/50 p-4 transition-all hover:bg-muted",children:[(0,r.jsxs)("div",{className:`flex h-12 w-12 shrink-0 items-center justify-center rounded-xl font-bold ${1===e.rank?"bg-yellow-500/20 text-yellow-500":2===e.rank?"bg-gray-400/20 text-gray-400":3===e.rank?"bg-orange-600/20 text-orange-600":"bg-primary/10 text-primary"}`,children:["#",e.rank]}),(0,r.jsxs)(n.Avatar,{className:"h-12 w-12 border-2 border-border",children:[(0,r.jsx)(n.AvatarImage,{src:e.avatar||"/placeholder.svg",alt:e.username}),(0,r.jsx)(n.AvatarFallback,{children:e.username[0]?.toUpperCase()})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-semibold text-foreground",children:e.username}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.value," messages"]})]}),1===e.rank&&(0,r.jsxs)(o.Badge,{className:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",children:[(0,r.jsx)(c.Trophy,{className:"mr-1 h-3 w-3"}),"Champion"]})]},e.discordId))})})]})}),(0,r.jsx)(i.TabsContent,{value:"voice",className:"mt-6",children:(0,r.jsxs)(s.Card,{className:"border-border bg-card",children:[(0,r.jsxs)(s.CardHeader,{children:[(0,r.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.Trophy,{className:"h-5 w-5 text-yellow-500"}),"Top 10 Vocal"]}),(0,r.jsx)(s.CardDescription,{children:"Les membres les plus actifs en vocal cette semaine"})]}),(0,r.jsx)(s.CardContent,{children:0===x.length?(0,r.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"Aucune donnée disponible pour cette semaine"}):(0,r.jsx)("div",{className:"space-y-3",children:x.map(e=>{var t;let a,s;return(0,r.jsxs)("div",{className:"flex items-center gap-4 rounded-2xl bg-muted/50 p-4 transition-all hover:bg-muted",children:[(0,r.jsxs)("div",{className:`flex h-12 w-12 shrink-0 items-center justify-center rounded-xl font-bold ${1===e.rank?"bg-yellow-500/20 text-yellow-500":2===e.rank?"bg-gray-400/20 text-gray-400":3===e.rank?"bg-orange-600/20 text-orange-600":"bg-primary/10 text-primary"}`,children:["#",e.rank]}),(0,r.jsxs)(n.Avatar,{className:"h-12 w-12 border-2 border-border",children:[(0,r.jsx)(n.AvatarImage,{src:e.avatar||"/placeholder.svg",alt:e.username}),(0,r.jsx)(n.AvatarFallback,{children:e.username[0]?.toUpperCase()})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-semibold text-foreground",children:e.username}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:(a=Math.floor((t=e.value)/3600),s=Math.floor(t%3600/60),a>0?`${a}h ${s}m`:`${s}m`)})]}),1===e.rank&&(0,r.jsxs)(o.Badge,{className:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",children:[(0,r.jsx)(c.Trophy,{className:"mr-1 h-3 w-3"}),"Champion"]})]},e.discordId)})})})]})})]})]})}e.s(["default",()=>g],35955)}]);